export function getObjectData(app, objectId) {
  return new Promise((resolve, reject) => {
    getObjectModel(app, objectId).then((_model) => {
      // Eğer model null veya undefined ise hata fırlatalım
      if (!_model || !_model.layout || !_model.layout.qHyperCube) {
        reject(new Error('Geçersiz model veya qHyperCube bulunamadı.'));
        return;
      }

      const qWidth = _model.layout.qHyperCube.qSize.qcx;
      const totalRows = _model.layout.qHyperCube.qSize.qcy; // Toplam satır sayısı
      const maxRowsPerFetch = Math.floor(10000 / qWidth);

      let qTop = 0;
      const fetchedData = [];

      function fetchChunk() {
        const qHeight = Math.min(maxRowsPerFetch, totalRows - qTop);

        _model
          .getHyperCubeData('/qHyperCubeDef', [
            {
              qTop,
              qLeft: 0,
              qWidth,
              qHeight,
            },
          ])
          .then((_data) => {
            if (!_data || !_data[0] || !_data[0].qMatrix) {
              reject(new Error('Veri çekilirken sorun oluştu.'));
              return;
            }

            fetchedData.push(..._data[0].qMatrix); // Gelen veriyi birleştir
            qTop += qHeight; // Bir sonraki başlangıç noktasını ayarla

            if (qTop < totalRows) {
              // Eğer tüm veri alınmadıysa, tekrar çağır
              fetchChunk();
            } else {
              // Tüm veri alındığında çözümle
              resolve(fetchedData);
            }
          })
          .catch((error) => {
            reject(new Error(`getHyperCubeData hatası: ${error.message}`)); // Hata mesajını daha detaylı yazdırıyoruz
          });
      }

      fetchChunk();
    }).catch((error) => {
      reject(new Error(`getObjectModel hatası: ${error.message}`)); // Hata mesajını daha detaylı yazdırıyoruz
    });
  });
}
