// Veriyi alıp güncelleyen fonksiyon
const fetchDataAndUpdate = (app, objectId) => {
    getObjectData(app, objectId).then((response) => {
        if (!response) {
            console.error('MultiBarChart Component : response verisi boş veya tanımsız.');
            return;
        }
        const incomingData = response.map(item => ({
            name: item[0].qText,
            value: item[1].qNum,
            valueText: item[1].qText
        }));
        console.log(incomingData);
        // Yeni gelen veriyi data state'ine set ediyoruz
        setData(incomingData); // Bu işlem data'yı güncelleyecek ve grafik yeniden çizilecek
    }).catch((error) => {
        console.error('getObjectData error:', error);
    });
};
.on("click", (event, d) => {
    console.log(d);

    const clickedValue = d.name; // Tıklanan barın değerini alıyoruz 
    setClickedChart(!clickedChart); // clickedChart durumunu değiştiriyoruz

    // Qlik objesine filtre atmak
    if (app) {
        console.log(app.selectionState().selections); 

        // Seçim durumu kontrolü
        const selectionsLength = app.selectionState().selections.length;

        if (selectionsLength > 0) {
            // Eğer seçili alan varsa, başka bir alana filtre atıyoruz
            console.log("Seçim yapıldı. Başka bir alana filtre uygulanacak.");
            
            // Burada başka bir alanı filtreleyelim. Örnek olarak 'Region' field'ı:
            app.field("Region").selectValues([clickedValue], true).then(() => {
                console.log('Region alanına filtre uygulandı:', clickedValue);

                // Region filtresi uygulandıktan sonra getObjectData çağırılıyor
                fetchDataAndUpdate(app, objectId); // Veriyi alıp güncelleyen fonksiyonu çağırıyoruz
            }).catch((error) => {
                console.error('Region alanına filtre uygulama hatası:', error);
            });

        } else {
            // Eğer hiçbir seçim yoksa, mevcut alanı filtreliyoruz
            console.log("Seçim yapılmadı. Mevcut alana filtre uygulanacak.");
            
            app.field("UnitName").selectValues([clickedValue]).then(() => {
                // UnitName filtresi uygulandıktan sonra getObjectData çağırılıyor
                fetchDataAndUpdate(app, objectId); // Veriyi alıp güncelleyen fonksiyonu çağırıyoruz
            }).catch((error) => {
                console.error('UnitName alanına filtre uygulama hatası:', error);
            });
        }
    }
});
